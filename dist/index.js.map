{"version":3,"sources":["../src/index.js"],"names":["constructor","polling","publ","destructors","Set","running","stopped","start","ms","timer","stop","add","timeout","forEach","destructor","undefined"],"mappings":";;;;;;;;;;;AAAA;;AAEA,IAAMA,WAAW,GAAG,SAAdA,WAAc,CAACC,OAAD,EAAa;AAC7B,MAAMC,IAAI,GAAG,EAAb;AACA,MAAMC,WAAW,GAAG,IAAIC,GAAJ,EAApB;AACA,MAAIC,OAAJ;AACA,MAAIC,OAAJ;;AAEAJ,EAAAA,IAAI,CAACK,KAAL,GAAa,YAAM;AACfF,IAAAA,OAAO,GAAG,IAAV;AACAC,IAAAA,OAAO,GAAGL,OAAO,CACb;AAAA,aAAMI,OAAN;AAAA,KADa,EAEb,UAACG,EAAD,EAAQ;AACJ,UAAMC,KAAK,GAAG,oCAAMD,EAAN,EAAU,YAAM;AAC1BL,QAAAA,WAAW,UAAX,CAAmBM,KAAK,CAACC,IAAzB;AACH,OAFa,CAAd;AAGAP,MAAAA,WAAW,CAACQ,GAAZ,CAAgBF,KAAK,CAACC,IAAtB;AACA,aAAOD,KAAK,CAACG,OAAb;AACH,KARY,CAAjB;AAUH,GAZD;;AAcAV,EAAAA,IAAI,CAACQ,IAAL,GAAY,YAAM;AACdL,IAAAA,OAAO,GAAG,KAAV;AACAF,IAAAA,WAAW,CAACU,OAAZ,CAAoB,UAAAC,UAAU;AAAA,aAAIA,UAAU,EAAd;AAAA,KAA9B;AACA,WAAOR,OAAP;AACH,GAJD;;AAMAJ,EAAAA,IAAI,CAACY,UAAL,GAAkB,YAAM;AACpB,QAAIT,OAAJ,EAAa,OAAOH,IAAI,CAACQ,IAAL,EAAP;AACb,WAAOK,SAAP;AACH,GAHD;;AAKA,SAAOb,IAAP;AACH,CAhCD;;eAkCe;AACXF,EAAAA,WAAW,EAAXA;AADW,C","sourcesContent":["import delay from 'interruptible-timer';\n\nconst constructor = (polling) => {\n    const publ = {};\n    const destructors = new Set();\n    let running;\n    let stopped;\n\n    publ.start = () => {\n        running = true;\n        stopped = polling(\n            () => running,\n            (ms) => {\n                const timer = delay(ms, () => {\n                    destructors.delete(timer.stop);\n                });\n                destructors.add(timer.stop);\n                return timer.timeout;\n            },\n        );\n    };\n\n    publ.stop = () => {\n        running = false;\n        destructors.forEach(destructor => destructor());\n        return stopped;\n    };\n\n    publ.destructor = () => {\n        if (running) return publ.stop();\n        return undefined;\n    };\n\n    return publ;\n};\n\nexport default {\n    constructor,\n};\n"],"file":"index.js"}